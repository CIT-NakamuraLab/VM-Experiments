# vSAN
## 概要
- 実験日: 2022/09/23
- vSAN

目次
- [vSAN](#vsan)
  - [概要](#概要)
  - [1. vSANとは](#1-vsanとは)
  - [2. SANとは?](#2-sanとは)
  - [3. DAS NAS SAN　の違い](#3-das-nas-sanの違い)
  - [4.SANの接続方法](#4sanの接続方法)
  - [5.Fibre Channelのデメリット](#5fibre-channelのデメリット)
  - [6.iSCSIのメリット](#6iscsiのメリット)
  - [7.インフラ構成](#7インフラ構成)
  - [8.vSAN構築方法](#8vsan構築方法)

## 1. vSANとは
- ストレージ仮想化ソフトウェアの1つ

## 2. SANとは?
ストレージとサーバー間に対して､専用のネットワークを構築し接続することによって､高効率化や冗長化などを目的としたストレージに対する接続形態の1つ｡　　
1つのストレージに対して､複数のサーバー情報を保存することができるため､最大限のリソースを利用することが可能になる｡また､サーバーが停止した際には､ストレージと接続している別のサーバーにアプリケーションを移すことが可能になる耐障害性の問題を回避することができる｡

## 3. DAS NAS SAN　の違い

|| DAS | NAS | SAN |
|:----| :---- | :---- | :---- |
| 特徴 | ･ブロックストレージ<br>･サーバーとストレージの直接接続|･ファイルストレージ<br>･同じLAN内に設置しサーバーとストレージを接続|･ブロックストレージ<br>･ストレージ専用のネットワークを構築しサーバーとストレージを接続|
|メリット|単純|SANより単純|最大限のリソースを利用可能になる|
| デメリット | ･ホスト数の数だけストレージが必要である点<br>･ストレージが分散されることで把握が困難になる点|･同じLAN内のため､通信が混み合っている際は､スループット低下に直結する点 |･1つのストレージに複数のVMを入れることになるため管理が難しい<br>･専用のネットワークを構築する必要からコストが他の2つと比較して高い点|

- ブロックストレージ:ストレージ領域を貼る範囲に切り出してブロックにして管理し割り当てる｡
- ファイルストレージ:ファイルやディレクトリにて階層的に管理する｡

## 4.SANの接続方法

- **Fibre Channel**
- **iSCSI**

## 5.Fibre Channelのデメリット 
  - FC専用のルータやスイッチなどを購入する必要があるため高価
  - FC専用ネットワークを構築する必要がある
  - 専用のルータなので設定が難しい
  - メンテナンスコストが高い

## 6.iSCSIのメリット
  - 専用品を必要としないため経費を抑えられる点
  - FC専用ネットワークの構築に労力を掛ける必要がない点
  - iSCSIのパケットは､TCP通信で行われることから通信をすべてIPに統合できるため管理を容易にすることができる点
  - TCPパケット内には､SCSIコマンドが入っているため通信エラーなどの問題の際には確認しやすい

## 7.インフラ構成
サーバー及びストレージネットワーク､ストレージプールの3層構造になっている｡
  - **3Tier**
    - 異なるメーカのモデルを組み合わせることができるため自由に増設可能
  - **CI**
    - パッケージ化された物
    - 要件定義を細かく決定していないと増設の際にすべての設定を見直す必要があるため難しい
  - **HCI**
    - サーバーやストレージネットワーク､ストレージプールのすべてをソフトウェア上で接続する
    - 仮想的にSANをソフトウェア上で構成することをvSANという

## 8.vSAN構築方法
以下に通りに構築するとvSANを利用することが出来る

クラスタを組む

Clusterから構成欄を選択しサービスにてvSAN項目のサービスを選択する。

構成タイプ欄にて、単一のサイトクラスタを選択する。

サービス欄にて、何も選択せずに次へを選択する。

ディスク要求欄の次でグループ化の部分では、ホストを選択する。また、vSANを構築するためには、キャッシュ層つまり実行容量にカウントされないストレージデバイスが1台以上必要なため高速な読み書きが可能なSSDを利用する。以上の理由から、SSDの要求対象の欄には、キャッシュ層を選択する。そして、HDDの要求対象の欄には、キャパシティ層を選択する。